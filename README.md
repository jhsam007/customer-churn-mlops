# Customer Churn Prediction System (Production-Grade MLOps)
# é¡§å®¢ãƒãƒ£ãƒ¼ãƒ³äºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³å¯¾å¿œMLOpsï¼‰

An end-to-end, production-ready machine learning system for predicting customer churn using structured telecom data.

æ§‹é€ åŒ–ã•ã‚ŒãŸé€šä¿¡ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦é¡§å®¢ã®è§£ç´„ï¼ˆãƒãƒ£ãƒ¼ãƒ³ï¼‰ã‚’äºˆæ¸¬ã™ã‚‹ã€ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã®æœ¬ç•ªç’°å¢ƒå¯¾å¿œæ©Ÿæ¢°å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

This project demonstrates a complete ML lifecycle â€” from data preprocessing to containerized deployment â€” following MLOps best practices.

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†ã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒŠåŒ–ã•ã‚ŒãŸãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã¾ã§ã€MLOpsã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«åŸºã¥ã„ãŸå®Œå…¨ãªMLãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚


---
## Live System Preview

<p align="center">
  <img src="assets/swagger_ui.png" width="800"/>
</p>

---

## Business Problem
## ãƒ“ã‚¸ãƒã‚¹èª²é¡Œ

Customer churn significantly impacts subscription-based businesses and recurring revenue models.

ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³å‹ãƒ“ã‚¸ãƒã‚¹ã«ãŠã„ã¦ã€é¡§å®¢ã®è§£ç´„ã¯åç›Šã«å¤§ããªå½±éŸ¿ã‚’ä¸ãˆã¾ã™ã€‚

Early identification of high-risk customers enables:
- Targeted retention strategies
- Reduced revenue loss
- Improved customer lifetime value (CLV)

è§£ç´„ãƒªã‚¹ã‚¯ã®é«˜ã„é¡§å®¢ã‚’æ—©æœŸã«ç‰¹å®šã™ã‚‹ã“ã¨ã§ã€ä»¥ä¸‹ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ï¼š

- åŠ¹æœçš„ãªãƒªãƒ†ãƒ³ã‚·ãƒ§ãƒ³æ–½ç­–
- åç›Šæå¤±ã®å‰Šæ¸›
- é¡§å®¢ç”Ÿæ¶¯ä¾¡å€¤ï¼ˆCLVï¼‰ã®å‘ä¸Š

This system predicts churn probability and applies configurable business thresholds to support practical decision-making.

æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯è§£ç´„ç¢ºç‡ã‚’äºˆæ¸¬ã—ã€ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ã«å¿œã˜ãŸé–¾å€¤è¨­å®šã«ã‚ˆã‚Šå®Ÿç”¨çš„ãªæ„æ€æ±ºå®šã‚’æ”¯æ´ã—ã¾ã™ã€‚

---

## Key Features  
## ä¸»ãªç‰¹å¾´

- End-to-end ML pipeline (training â†’ evaluation â†’ deployment)  
  å­¦ç¿’ã‹ã‚‰è©•ä¾¡ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã¾ã§ã‚’å«ã‚€ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã®MLãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

- Hyperparameter tuning with Optuna (30 trials)  
  Optunaã‚’ç”¨ã„ãŸãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ï¼ˆ30è©¦è¡Œï¼‰

- Experiment tracking with MLflow  
  MLflowã«ã‚ˆã‚‹å®Ÿé¨“ç®¡ç†ãƒ»ãƒ¢ãƒ‡ãƒ«ç®¡ç†

- Configurable decision threshold layer  
  ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ã«å¿œã˜ã¦èª¿æ•´å¯èƒ½ãªæ„æ€æ±ºå®šé–¾å€¤ãƒ¬ã‚¤ãƒ¤ãƒ¼

- Model explainability using SHAP  
  SHAPã«ã‚ˆã‚‹ãƒ¢ãƒ‡ãƒ«ã®è§£é‡ˆæ€§ãƒ»ç‰¹å¾´é‡é‡è¦åº¦ã®å¯è¦–åŒ–

- REST API serving with FastAPI + Swagger UI  
  FastAPIã«ã‚ˆã‚‹æ¨è«–APIæ§‹ç¯‰ãŠã‚ˆã³Swagger UIã«ã‚ˆã‚‹è‡ªå‹•ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆ

- Docker containerization  
  Dockerã«ã‚ˆã‚‹ã‚³ãƒ³ãƒ†ãƒŠåŒ–ï¼ˆæœ¬ç•ªç’°å¢ƒã‚’æƒ³å®šï¼‰

- CI/CD with GitHub Actions  
  GitHub Actionsã«ã‚ˆã‚‹CI/CDè‡ªå‹•åŒ–

- Unit testing with Pytest (7/7 passing, 68% coverage)  
  Pytestã«ã‚ˆã‚‹å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè£…ï¼ˆ7/7æˆåŠŸã€ã‚«ãƒãƒ¬ãƒƒã‚¸68%ï¼‰

- Reproducible and modular project structure  
  å†ç¾æ€§ãŠã‚ˆã³æ‹¡å¼µæ€§ã‚’è€ƒæ…®ã—ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­è¨ˆ


---
---

## ğŸ“‚ Dataset
## ğŸ“‚ ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ

This project uses the IBM Telco Customer Churn Dataset.

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€IBM Telco Customer Churn Dataset ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

- Records: 7,043 customers  
- Features: 20+ structured attributes  
- Target Variable: `Churn` (Yes/No)  
- Churn Rate: ~26.5%

- ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ï¼š7,043ä»¶  
- ç‰¹å¾´é‡ï¼š20ä»¥ä¸Šã®æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿  
- ç›®çš„å¤‰æ•°ï¼š`Churn`ï¼ˆè§£ç´„æœ‰ç„¡ï¼‰  
- è§£ç´„ç‡ï¼šç´„26.5%

### Data Characteristics
### ãƒ‡ãƒ¼ã‚¿ç‰¹æ€§

- Mixture of categorical and numerical variables  
- Imbalanced binary classification problem  
- Requires preprocessing and encoding  

- ã‚«ãƒ†ã‚´ãƒªå¤‰æ•°ã¨æ•°å€¤å¤‰æ•°ã®æ··åœ¨  
- ä¸å‡è¡¡ãªäºŒå€¤åˆ†é¡å•é¡Œ  
- å‰å‡¦ç†ãŠã‚ˆã³ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒå¿…è¦  


## System Architecture

```
Raw CSV Dataset
      â†“
Data Loader
      â†“
Preprocessing (ColumnTransformer)
      â†“
ML Pipeline (XGBoost / Logistic Regression)
      â†“
MLflow Experiment Tracking
      â†“
Probability Output
      â†“
Decision Layer (Configurable Threshold)
      â†“
Explainability (SHAP)
      â†“
FastAPI Inference
      â†“
Docker Container
```

---

## Model Performance

| Model | ROC-AUC | Precision | Recall | F1 |
|-------|---------|-----------|--------|-----|
| XGBoost | 0.847 | 0.59 | 0.663 | 0.624 |
| Logistic | 0.842 | 0.568 | 0.668 | 0.614 |

**Selected model:** XGBoost with decision threshold tuned to `0.4`

| Threshold | Recall | Precision |
|-----------|--------|-----------|
| 0.5 | 54.8% | 63.5% |
| 0.4 âœ… | 66.3% | 59.0% |
| 0.3 | 74.9% | 52.6% |

---

## System Screenshots

### MLflow Experiment Tracking

<p align="center">
  <img src="assets/mlflow_ui.png" width="800"/>
</p>

<p align="center">
  <em>Experiment comparison and hyperparameter tuning results tracked via MLflow.</em>
</p>

---

### FastAPI Swagger Documentation

<p align="center">
  <img src="assets/swagger_ui.png" width="800"/>
</p>

<p align="center">
  <em>Interactive REST API documentation auto-generated by FastAPI.</em>
</p>

---

### SHAP Feature Importance

<p align="center">
  <img src="assets/shap_plot.png" width="700"/>
</p>

<p align="center">
  <em>Global feature importance using SHAP explainability.</em>
</p>

---

### Confusion Matrix

<p align="center">
  <img src="assets/confusion_matrix.png" width="600"/>
</p>

<p align="center">
  <em>Model performance visualization at decision threshold 0.4.</em>
</p>


---

## Tech Stack

| Category | Tools |
|----------|-------|
| Language | Python 3.10 |
| ML | scikit-learn, XGBoost |
| Tuning | Optuna |
| Explainability | SHAP |
| Tracking | MLflow |
| API | FastAPI |
| Serving | Uvicorn |
| Testing | Pytest |
| CI/CD | GitHub Actions |
| Containerization | Docker |

---

## Project Structure

```
customer-churn/
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ mlflow_ui.png
â”‚   â”œâ”€â”€ swagger_ui.png
â”‚   â”œâ”€â”€ shap_plot.png
â”‚   â””â”€â”€ confusion_matrix.png
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config.py
â”‚   â”œâ”€â”€ data_loader.py
â”‚   â”œâ”€â”€ preprocessing.py
â”‚   â”œâ”€â”€ modeling.py
â”‚   â”œâ”€â”€ evaluation.py
â”‚   â”œâ”€â”€ decision.py
â”‚   â”œâ”€â”€ explainability.py
â”‚   â”œâ”€â”€ pipeline.py
â”‚   â””â”€â”€ utils.py
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_decision.py
â”‚   â”œâ”€â”€ test_modeling.py
â”‚   â”œâ”€â”€ test_pipeline.py
â”‚   â””â”€â”€ test_preprocessing.py
â”œâ”€â”€ notebooks/
â”‚   â”œâ”€â”€ 01_eda.ipynb
â”‚   â”œâ”€â”€ 02_experiments.ipynb
â”‚   â”œâ”€â”€ 03_model_explainability.ipynb
â”‚   â””â”€â”€ 04_evaluation.ipynb
â”œâ”€â”€ models/
â”œâ”€â”€ data/
â”‚   â””â”€â”€ raw/
â”œâ”€â”€ app.py
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ pyproject.toml
â””â”€â”€ README.md
```

---

## How to Run

### 1. Install Dependencies
```bash
pip install -e .[dev]
```

### 2. Train the Model
```bash
python src/pipeline.py
```

### 3. Launch MLflow UI
```bash
mlflow ui
```
Open: http://127.0.0.1:5000

### 4. Run the API
```bash
uvicorn app:app --reload
```
- API: http://127.0.0.1:8000
- Swagger UI: http://127.0.0.1:8000/docs

### 5. Run with Docker
```bash
docker build -t churn-api .
docker run -p 8000:8000 churn-api
```

### 6. Run Tests
```bash
pytest
pytest --cov=src  # with coverage
```

---

## API Usage

**POST** `/predict`

```json
{
  "gender": "Female",
  "SeniorCitizen": 0,
  "Partner": "Yes",
  "Dependents": "No",
  "tenure": 5,
  "PhoneService": "Yes",
  "MultipleLines": "No",
  "InternetService": "Fiber optic",
  "OnlineSecurity": "No",
  "OnlineBackup": "Yes",
  "DeviceProtection": "No",
  "TechSupport": "No",
  "StreamingTV": "Yes",
  "StreamingMovies": "Yes",
  "Contract": "Month-to-month",
  "PaperlessBilling": "Yes",
  "PaymentMethod": "Electronic check",
  "MonthlyCharges": 89.5,
  "TotalCharges": 450.3
}
```

**Response:**
```json
{
  "churn_probability": 0.755,
  "decision_threshold": 0.4,
  "churn_label": 1
}
```

---

## CI/CD

GitHub Actions automatically runs on every push:
- Unit tests
- Coverage checks

---
---

## ğŸ‡¯ğŸ‡µ æ—¥æœ¬èªæ¦‚è¦

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€å®Ÿå‹™ã‚’æƒ³å®šã—ãŸMLOpsæ§‹æˆã®æ©Ÿæ¢°å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

- XGBoostãŠã‚ˆã³ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã«ã‚ˆã‚‹åˆ†é¡ãƒ¢ãƒ‡ãƒ«æ§‹ç¯‰
- Optunaã«ã‚ˆã‚‹ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–
- MLflowã«ã‚ˆã‚‹å®Ÿé¨“ç®¡ç†
- SHAPã«ã‚ˆã‚‹ãƒ¢ãƒ‡ãƒ«è§£é‡ˆæ€§ã®å¯è¦–åŒ–
- FastAPIã«ã‚ˆã‚‹REST APIåŒ–
- Dockerã«ã‚ˆã‚‹ã‚³ãƒ³ãƒ†ãƒŠåŒ–
- GitHub Actionsã«ã‚ˆã‚‹CI/CD

ãƒ‡ãƒ¼ã‚¿åˆ†æã‹ã‚‰æœ¬ç•ªé‹ç”¨ã‚’æƒ³å®šã—ãŸAPIæä¾›ã¾ã§ã€ä¸€è²«ã—ãŸæ©Ÿæ¢°å­¦ç¿’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

## Author

**Hasan Jahid**
